<!-- -*- coding:utf-8 -*- -->
<html>
<head>
  <title>login dialog</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
</head>
<body>
  <h2>Hello</h2>
  <button id="start" onclick="sendMessage()">メッセージ送信</button>
  <script>
    function onMessageFromParent(arg) {
      console.log('onMessageFromParent called');
      console.log(arg);
    }
    Office.onReady()
    .then(function() {
        Office.context.ui.addHandlerAsync(
            Office.EventType.DialogParentMessageReceived,
            onMessageFromParent);
    });

    function sendMessage() {
      Office.context.ui.messageParent("Some message", { targetOrigin: "*" });
    }
  </script>
</body>
</html>
