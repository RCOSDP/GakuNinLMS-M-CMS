<!-- -*- coding:utf-8 -*- -->
<html>
<head>
  <title>login dialog</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
  <script src="./js.cookie.min.js"></script>
</head>
<body>
  <h2>
ログイン処理が終了しました。<br>
終了ボタンを押してウィンドウを閉じてください。
  </h2>
  <button id="start" onclick="sendMessage()">終了</button>
  <script>
    function onMessageFromParent(arg) {
      console.log('onMessageFromParent called');
      console.log(arg);
    }
    Office.onReady()
    .then(function() {
        Office.context.ui.addHandlerAsync(
            Office.EventType.DialogParentMessageReceived,
            onMessageFromParent);
    });

    function sendMessage() {
      Office.context.ui.messageParent(Cookies.get('session_cookie'), { targetOrigin: "*" });
      window.close();
    }

    console.log(Cookies.get('session_cookie'));
  </script>
</body>
</html>
