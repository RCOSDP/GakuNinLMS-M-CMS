<html>

<head>
  <title>test page</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body>
  <button onclick="file1()">open directory</button>
  <button onclick="file3()">getPptx</button>
  <button onclick="file4()">list files</button>
  <button onclick="file5()">prepare</button>
  <button onclick="file6()">createImportJson</button>
  <br><br>
  <a id="down">download</a>
  <br><br>
  <textarea id="msgbox" rows=5 cols=80></textarea>
  <br><br>
  <video id="video" width="640" height="400" controls></video>
</body>

<script src="browser.js"></script>

<script>
let pptx;

const {setRoot, readFile, writeFile, openDir} = ppt2video;

function arraybuffer2string(buf) {
  return String.fromCharCode.apply("", new Uint8Array(buf));
}

async function file1() {
  const dirHandle = await window.showDirectoryPicker();
  setRoot(dirHandle);
  console.log(dirHandle);
}

async function file3() {
  pptx = await ppt2video.getPptx('vuca.pptx');
  const slides = await pptx.pptx2slide();
  console.log(slides);
}

async function file4() {
  const dir = await openDir("vuca");
  const it = await dir.entries();
  for await (const e of it) {
    console.log(e);
  }
}

async function file5() {
  await pptx.prepare();
}

async function file6() {
  const ij = pptx.createImportJson();
  console.log(ij);
}
</script>