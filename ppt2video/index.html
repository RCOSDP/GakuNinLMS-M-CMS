<html>

<head>
  <title>test page</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body>
  <button onclick="file1()">opendir</button>
  <button onclick="file3()">ppt2video</button>
  <button onclick="file4()">list files</button>
  <button onclick="file5()">prepare</button>
  <button onclick="file6()">import json</button>
  <br><br>
  <a id="down">download</a>
  <br><br>
  <textarea id="msgbox" rows=5 cols=80></textarea>
  <br><br>
  <video id="video" width="640" height="400" controls></video>
</body>

<script src="browser.js"></script>

<script>
let dirHandle;
let pptx;
let p2v;

async function readFile(filename) {
  const fh = await dirHandle.getFileHandle(filename);
  const file = await fh.getFile();
  return file.arrayBuffer();
}

async function writeFile(filename, data) {
  const fh = await dirHandle.getFileHandle(filename,{create:true});
  const ws = await fh.createWritable();
  await ws.write(data);
  await ws.close();
}

async function openDir(dirname) {
  return dirHandle.getDirectoryHandle(dirname);
}

function arraybuffer2string(buf) {
  return String.fromCharCode.apply("", new Uint8Array(buf));
}

async function file1() {
  dirHandle = await window.showDirectoryPicker();
  console.log(dirHandle);
}

async function file3() {
  const buf = await readFile('vuca.pptx');
  pptx = await ppt2video.getPptxData(buf);
  const slides = await pptx.pptx2slide();
  console.log(slides);
}

async function file4() {
  const dir = await openDir("vuca");
  const it = await dir.entries();
  for await (const e of it) {
    console.log(e);
  }
}

async function file5() {
  p2v = await ppt2video.prepare(pptx);
}

async function file6() {
  const ij = ppt2video.createImportJson(p2v);
  console.log(ij);
}
</script>